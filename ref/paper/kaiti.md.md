## 问题背景
### 通信系统与信道
第五代无线接入技术 (5G)，被称为 New Radio (NR)，将解决各种使用场景，从增强的移动宽带到超可靠的低延迟通信，再到大规模机器式通信。关键技术特点包括超精益传输，支持低延迟，先进的天线技术，频谱灵活性，包括在高频段操作和高低频频段之间的相互工作，是未来通信发展的风向标。而无线通信系统的性能很大程度上受到无线信道的影响，接收机与发射机之间的传播路径非常复杂，信道估计的精度将直接影响整个系统的性能，从而其是一项非常重要的任务。在 New Radio 标准下，通信系统涵盖多类物理信道，如物理随机接入信道 (PRACH)、物理下行共享信道 (PDSCH)、物理上行共享信道 (PUSCH)、物理下行控制信道 (PDCCH)、物理上行控制信道 (PUCCH)等。其中 PDSCH 是 LTE 中主要承载用户数据的下行链路通道，在系统中有重要意义。
而在实际的通信系统中，任何信号在传输过程中均会受到由于不理想信道带来的污染，多种噪声会加在信号本身，给接收端的解调以及检测等工作带来很大的阻碍。为了能够提高通信系统的效率，我们需要尽可能消除不理想信道导致的信号扭曲，而这就需要我们对信道的特征进行描述，也就是信道估计。通常信道估计是通过比较已知信号在收发机两端的不同来获得大致的信道矩阵。整体过程为：首先在发射机端，我们发送一系列已知参考信号，即导频信号，这些导频信号通常经过一定的设计使其便于在接收端检测得到；随后这些信号通过信道被噪声扭曲；最后我们在接收机端收到相关信号，通过比较收发信号的差异，我们得到其相关关系，从而得到对信道的估计。
### 参考信号
参考信号，即为导频信号，是发射端提供给接收端用于信道估计或者信道探测的一种已知信号。在收到信号之后，若已知信道信息，即可解调接收信号得到发射信号。对于物理下行共享信道 ，常用解调参考信号信号即解调参考信号 (Demodulation Reference Signal，DMRS) 进行估计以及相关解调。解调参考信号在时频平面上占有少量的位置，并随数据信号在发射机发送。接收机知道解调参考信号的时频位置和值。在接收端，通过比较发送和接收的解调参考信号，得到解调参考信号子信道矩阵。解调参考信号信道估计的目的是基于解调参考信号子信道矩阵得到各时频位置的信道响应，并恢复全信道矩阵。由于解调参考信号的密度较低、且由于 5G 的应用需要面对高动态的应用场景，单个符号内的信道变化可能会越来越严重，传统的线性恢复算法，如维纳滤波等，在实际部署时仍然有效但不是最优算法。为了提高信道估计的精度与准确性，以及提高信道估计过程中，系统对噪声的抑制能力，我们需要设计更加有效的算法。深度学习是一个复杂的机器学习算法，在语音和图像识别方面取得的效果，远远超过先前相关技术。与传统方法相比，基于深度学习的技术的优点之一是其鲁棒性。尤其是当数据量较大时，深度学习具有优于传统方法的描述数据特征的良好表征能力。
### 相关工作
最近几年内，深度学习在多个领域取得重大突破，在通信领域也得到了广泛关注。其优秀的非线性拟合能力以及学习能力使其能够从数据中学习到一定的规律，获得比传统方法更优异的性能，如准确性、鲁棒性。在通信领域已有多个课题运用深度学习，包括信道估计、信号检测、编码与解码等。在数据传输速率与带宽不断增大的发展趋势下，深度学习具有良好的应用前景。对于本研究题目，即基于深度学习的信道估计，已有论文进行讨论。如(5)(7)和(8)针对大型 MIMO 多用户系统提出了基于经典深度学习的结构，即线性层或卷积层的组合，提出了包括 LDAMP(5)、SFT-CNN(7) 等深度学习结构，取得了大幅优于超过经典算法，如 LMMSE（线性最小均方）、EM（最大期望）(2)(3)的效果。同时如 SPR-CNN(7) 等结构有助于压缩导频长度，节约宝贵的频谱资源。随着深度学习在图像处理领域的飞速发展，部分研究尝试将信道时频矩阵通过图像处理的方式进行估计(10)。部分研究尝试将专家知识嵌入深度学习结构，提出了基于理论模型的深度学习结构(5)(12)(13)。随着深度学习的发展，部分研究也在更新用于信道估计的深度学习结构(15)。

### 本研究的目的与意义
从深度学习受到热切关注开始，已有大量研究利用深度学习进行信道估计算法设计，但是限制于深度学习的结构特点以及通信领域的数据特点，这些研究存在部分问题，如难以同时关注信道的频域相关性和时域相关性；由于参考信号的稀疏性，在恢复高精度时频信息时，会将参考信号时频位置的噪声扩散至数据位置；而基于模型的深度学习结构会受模型精度的影响，从而限制其性能 。本研究旨在利用新进发展的深度学习方法，设计信道估计深度学习架构，依靠深度学习优秀的非线性拟合能力，提高在噪声环境下通过解调参考信号估计信道信息的准确率以及可靠性。
该研究有利于大幅降低接收信号解调误码率、抵抗多径效应以及扩展 5G 信号的应用场景 (如高动态环境)等多方面，是一项具有现实意义以及启发性的任务。在研究领域以及工业界均有重要意义。

## 研究主要内容与技术路线
### 主要研究内容
本研究基于2021年无线通信AI大赛（Wireless Communication AI Competition）赛道2：基于AI的信道估计。其基本内容如下：
针对32发送2接收天线（32T2R）的多天线信道环境下的 DMRS 信号设计相关的信道估计算法，使其具有良好的预测精度以及泛化能力。数据来自单小区单用户32T2R 的下行多天线信道，数据样本数量为21 万例样本。对于12 个子载波和14 个OFDM 符号，DMRS 图样请见图1示。每个样本的输入为H_in，维度为$48\times 2 \times 2$，分别对应48 个子载波，2 个符号，实部和虚部。每个样本的输出为H_out，维度为$96\times 14 \times 2$，分别对应96 个子载波，14 个符号，实部和虚部。频域一共有96 个子载波，H_out 占据所有子载波，而H_in 只占据其中的奇数子载波。时域一共有14 个OFDM 符号，H_out 占据所有OFDM 符号，而H_in 只占据其中第4 个和第12个 OFDM 符号。发送端采用波束赋形，将32 根发送天线的信号转化为一路信号，所有子载波采用相同的波束赋形向量。接收端有两根接收天线，但H_in 和H_out 只代表第一根接收天线的信号。每个样本的频域存在相关性，时域也同样存在相关性。需要充分利用该相关性以获得良好的预测性能。对于每个信道样本，，信道相关参数均为随机生成，如时延扩展、用户移动速度、信噪比等，其中仅有信噪比已知。
![[Pasted image 20211224095349.png]]
### 技术路线
#### 基础模型
深度学习近年来在自然语言处理（NLP）以及计算机视觉（CV）取得了引人注目的成就。在2017年提出的 Transfomer 模型(14)，其结构如图2所示。该基础模型由两个部分组成，图中左半部分的编码器（Encoder）与图中右半部分的解码器（Decoder）。其基本工作机制如下：在 Encoder 中，通过 Multi-Head Attention（多头注意力）模块建立时间维度的相关关系，将不同时间（第一个维度）的特征（第二个维度）联系起来，并且该模块强迫该模型对不同时刻的特征赋予不同比例的“注意力”。考虑到信道的特点，该模块有助于时频图像的恢复。Feed Forward 模块则进一步提取特征信息。在 Decoder 中，大部分模块与 Encoder 相同或类似，而 Masked Multi-Head Attention 模块通过遮盖当前时刻之后的信息，使得训练的行为方式与预测的行为方式一致。而 Positional Encoding 用于加载前后关系的信息。Transformer 在 NLP 问题上取得了显著的效果，并且其优秀的可移植性使得 CV 等领域也有大量相关工作利用 Transformer 提取图片中的语义信息，并进行如分类、语义分割、图像重建等任务。对于本研究的具体问题而言，我们可以将时频矩阵视为一张二维图像，则同样可以利用 CV 的思路进行处理。
![[Pasted image 20211224104929.png]]
#### 去噪与重建
Transformer 在 CV 已经得到大量运用。而针对信道估计问题，其中重点为对信道矩阵进行去噪以及根据稀疏的已知信道重建整个信道信息。根据之前叙述，我们可将该问题转化为 CV 问题，则我们需要讨论如何利用 Transformer 进行去噪以及图像重建。在此仅简单叙述可运用至该问题的具体模型。
对于去噪模型，2021年中科大团队利用 Transformer 建立了 Uformer 模型(Uformer)，如图3，其仿造 U-Net 架构，将特征空间维度扩大再压缩，同时特征空间尺度压缩再放大，从而提取出主要信息，抑制噪声信息。该方法在多个具体问题上取得了最佳指标，如去除摩尔纹、去雨等，且具有更低的计算复杂度。
![[Pasted image 20211224202215.png]]
对于重建模型，Transformer 同样也取得了引人注目的成绩。最近 FAIR 团队一篇论文提出了 Masked Autoencoders（MAE）(MAE)，能够从被大范围遮盖的残留图像恢复原始图像语义。如图4中结构，MAE 以未遮掩图像作为输入，经过编码器编码提取语义信息，随后输入 Decoder 进行图像重建。最终能有效恢复图像。该模型取得了 SOTA 结果。
![[Pasted image 20211224204452.png]]
综上，利用 Transformer 能够有效完成去噪与重建的工作，且有大量工作作为借鉴，为迁移学习提供帮助。

#### 问题迁移
在此我们将讨论利用 Transformer 进行信道估计的可能性以及一些注意点。对于信道时频矩阵，其每一个时刻与其他时刻的相关性不同，不同频段的频域相关性也不同，而 Transformer 中的注意力机制有利于深度学习模型寻找到该时频相关性。同时，利用上述基于 Transformer 的去噪器以及重建器，信道噪声可以被抑制，同时可以获得相比传统深度学习更加精确的信道估计结果。需要注意的是信道矩阵的尺度与传统图像处理不同，我们需要针对具体情况进行设计，以达到最佳效果。例如，可将信道的频谱信息作为初始特征，则 该问题又可以视为 NLP 问题；另外，去噪器与恢复器的前后顺序也需要注意，例如先进行信道恢复可能会带来噪声扩散的不良影响。

![image-20211231110148247](C:\Users\MSI1\AppData\Roaming\Typora\typora-user-images\image-20211231110148247.png)

## 进度安排
**2021-11-08**至**2021-11-21**：查阅相关资料，调研国内外研究现状。
**2021-11-22**至**2021-11-28**：完成外文翻译
**2021-11-29**至**2021-12-19**：熟悉DMRS信号及其信道特点。
**2021-12-20**至**2022-01-02**：撰写文献综述、文献翻译和开题报告，准备开题答辩。
**2022-01-03**至**2022-01-07**：开题答辩。
**2022-01-15**至**2022-02-17**：寒假。
**2022-02-21**至**2022-03-06**：完成DSMR信道估计方法研究并进行仿真分析。
**2022-03-07**至**2022-03-20**：完成已有基于AI估计DMRS信道的研究。
**2022-03-21**至**2022-04-17**：完成新的或改进基于AI估计DMRS信道方案的设计，与已有AI设计方案进行比较。
**2022-04-18**至**2022-05-01**：构建实验，完成数据采集与分析，对结果进行分析比较验证
**2022-05-02**至**2022-05-15**：撰写、修改并上传毕业论文。
**2022-05-16**至**2022-05-24**：查重、论文答辩。

## 预期目标
1、复现基于经典深度学习的信道估计算法。
2、基于 Transformer 设计新的深度学习结构，取得优于经典深度学习的效果。

## 参考文献
(5): H. He, C.-K. Wen, S. Jin, and G. Y. Li, “Deep learning-based channel estimation for beamspace mmWave massive MIMO systems,” IEEE Wireless Commun. Lett., vol. 7, no. 5, pp. 852–855, 2018.
(7): P. Dong, H. Zhang, G. Y. Li, I. S. Gaspar, and N. NaderiAlizadeh, “Deep CNN-based channel estimation for mmWave massive MIMO systems,” IEEE J. Sel. Topics in Signal Process., vol. 13, no. 5, pp. 989–1000, 2019.
(8): C.-J. Chun, J.-M. Kang, and I.-M. Kim, “Deep learning-based joint pilot design and channel estimation for multiuser MIMO channels,” IEEE Commun. Lett., vol. 23, no. 11, pp. 1999–2003, 2019.
(2): Z. Du, X. Song, J. Cheng, and N. C. Beaulieu, “Maximum likelihood based channel estimation for macrocellular OFDM uplinks in dispersive time-varying channels,” IEEE Trans. on Wireless Commun., vol. 10, no. 1, pp. 176–187, 2011.
(3): C. Jiang, H. Zhang, Y. Ren, Z. Han, K.-C. Chen, and L. Hanzo, “Machine learning paradigms for next-generation wireless networks,” IEEE Wireless Commun., vol. 24, no. 2, pp. 98–105, 2017.
(10): M. Soltani, V. Pourahmadi, A. Mirzaei, and H. Sheikhzadeh, “Deep learning-based channel estimation,” IEEE Commun. Lett., vol. 23, no. 4, pp. 652–655, 2019.
(12): C. K. Wen, W. T. Shih, and S. Jin, “Deep Learning for Massive MIMO CSI Feedback,” IEEE Wireless Commun. Lett., vol. 7, no. 5, 2018, pp. 748–51.
(13): T. Wang, C. Wen, S. Jin, G. Y. Li, "Deep Learning-Based CSI Feedback Approach for Time-Varying Massive MIMO Channels," IEEE Wireless Commun. Lett., Vol. 8, no. 2, pp. 416-419, 2019.